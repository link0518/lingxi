# 复制本文件为 .env 后再启动（不要把 .env 提交到仓库）
#
# =========================
# 服务端基础配置
# =========================
PORT=8787

# JWT 签名密钥（强烈建议生产环境设置）
# 后端默认值是 "lingxi_dev_secret"（见 server/auth.js），不设置也能跑，但上生产不安全。
# 建议使用一个长随机字符串。
JWT_SECRET=replace_me_with_a_long_random_string

# =========================
# “用户消失后 AI 主动关心”功能（Idle Nudge）
# =========================
# 开关：true/false（默认 false）。开启后，服务端会定时扫描“用户最新会话”，按 12/24/48 小时三档触发最多 3 次主动关心消息。
IDLE_NUDGE_ENABLED=true

# 扫描间隔（分钟）：建议 5~30，默认 10
IDLE_NUDGE_SCAN_INTERVAL_MINUTES=60

# 每轮扫描最多发送多少条主动消息（限流止损）：默认 20
IDLE_NUDGE_MAX_SENDS_PER_SWEEP=20

# 是否打印轻量日志（不包含密钥与完整 prompt）：默认 true
IDLE_NUDGE_LOG_ENABLED=true

# 参与生成的历史消息条数（仅用于 prompt 组装，越大越耗 tokens）：默认 40（范围 10~80）
IDLE_NUDGE_HISTORY_LIMIT=40

# =========================
# LLM 设置加密密钥（必须）
# =========================
# 用于加密存储用户在“API 设置”页填写的 LLM API Key（AES-256-GCM）。
# 必须是 32 字节随机值的 base64 编码（长度通常为 44 字符，末尾可能带 =）。
#
# 生成示例（PowerShell）：
#   [Convert]::ToBase64String((1..32 | ForEach-Object { Get-Random -Minimum 0 -Maximum 256 } | ForEach-Object { [byte]$_ }))
#
# 注意：
# - 未设置该值时，保存 API Key 会返回 error: LLM_SETTINGS_KEY_missing
# - 后台主动消息也无法解密读取用户 API Key，因此不会触发发送
LLM_SETTINGS_KEY=
